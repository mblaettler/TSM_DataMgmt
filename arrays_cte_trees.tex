
\section{Arrays, CTE, Trees}

\begin{breakbox}
\boxtitle{Create Table With Array:}
\sql{sql_code/array_create_table.sql}

%\begin{lstlisting}[language=SQL,aboveskip=1pt, belowskip=2pt]
%SELECT ARRAY[1,2,3+4];
%\end{lstlisting}
\end{breakbox}

\begin{breakbox}
\boxtitle{Insert:}
\sql{sql_code/array_insert.sql}
\end{breakbox}

\begin{breakbox}
\boxtitle{Constructors:}
\sql{sql_code/array_constructors.sql}
\end{breakbox}

\begin{breakbox}
\boxtitle{Select:}
\sql{sql_code/array_select.sql}
\end{breakbox}

\begin{breakbox}
\boxtitle{Operators:}
\sql{sql_code/array_operators.sql}
\end{breakbox}

\begin{breakbox}
\boxtitle{Functions:}
\sql{sql_code/array_functions.sql}

Further: not equal <>, comparison < =< > >= (lexicographical comparison of elements), contains @>, array-to-array concatenation ||.
\end{breakbox}

\begin{breakbox}
\boxtitle{CTE:}

Temporary, named result set. Can be referenced later and has recursion unlike a nested statement. Execution scope of a SELECT, INSERT, UPDATE, or DELETE statement.

\sql{sql_code/cte_non_recursive.sql}

\sql{sql_code/cte_recursive.sql}
\end{breakbox}

\begin{breakbox}
\boxtitle{Tree Data Structures:}

Given:
\begin{center}
	\includegraphics[width=.10\textwidth]{slides_images/tree_given_example}
\end{center}

\textbf{Adjacency list:}

\begin{tabular}{lll}
id & name   & parent\_id \\
\hline
1  & Animal & NULL       \\
2  & Bird   & 1          \\
3  & Dog    & 1          \\
4  & Cat    & 1         
\end{tabular}

\textbf{Nested Set:}
\begin{center}
	\includegraphics[width=.13\textwidth]{slides_images/trees_nested_set}
\end{center}

\begin{tabular}{llll}
id & name   & left & right \\
\hline
1  & Animal & 1    & 8     \\
2  & Bird   & 2    & 3     \\
3  & Dog    & 4    & 5     \\
4  & Cat    & 6    & 7    
\end{tabular}

\textbf{Materialised Path:}

\begin{tabular}{lll}
id & name   & lineage (e.g. ltree, array or string) \\
\hline
1  & Animal & 1                    \\
2  & Bird   & 1,2                  \\
3  & Dog    & 1,3                  \\
4  & Cat    & 1,4                 
\end{tabular}
\end{breakbox}